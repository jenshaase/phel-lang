(ns phel\test\core\threading-macros
  (:require phel\test :refer [deftest is-equals]))

# ----------------
# Threading macros
# ----------------

(deftest test->
  (is-equals 1 (-> 1))
  (is-equals 3 (-> 5 (+ 3) (/ 2) (- 1)))
  (is-equals 8 (-> [1 8 3 4] sort reverse first)))

(deftest test->>
  (is-equals 1 (->> 1))
  (is-equals 0.75 (->> 5 (+ 3) (/ 2) (- 1)))
  (is-equals @[2 3 4 5 6] (->> [1 2 [3 4] 5] flatten (map inc))))

(deftest test-as->
  (is-equals 1 (as-> 1 v))
  (is-equals -3 (as-> 5 v (+ 3 v) (/ v 2) (- 1 v)))
  (is-equals "oo" (as-> [:foo :bar] v (map |(php/-> $ (getName)) v) (first v) (php/substr v 1))))
