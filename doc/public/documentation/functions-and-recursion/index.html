<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Functions and Recursion | The Phel Language </title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="The offical website of the Phel language. Phel is a functional programming language that compiles to PHP.">

  <link rel="stylesheet" href="https:&#x2F;&#x2F;phel-lang.org&#x2F;site.css"/>
  <link rel="alternate icon" type="image/png" href="/favicon-32.png">

  <meta property="og:description" content="The offical website of the Phel language. Phel is a functional programming language that compiles to PHP." />
  <meta property="og:title" content="The Phel Language" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://phel-lang.org/" />
  <meta property="og:image" content="https://phel-lang.org/favicon-512.png" />
  <meta property="og:image:width" content="512" />
  <meta property="og:image:height" content="512" />
</head>

<body>
  
<div class="documentation">
    <aside class="documentation__sidebar">
        <div class="logo">
            <a href="/">
    <svg class="phel-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200.3 167.7"><path d="M6 66l95 96h36V93l-36-74H42L6 56v106h36l24-35"/><path d="M137 93l58-3-12-58-32-26h-34l-16 13-23 9-12 22 46 52z"/><path d="M195 90l-12 57h-13l-2-56M170 147l-13-11h12"/></svg>
</a>
        </div>

        <input type="checkbox" id="menu_checkbox">
        <label for="menu_checkbox">
            <svg viewBox="0 0 32 32">
                <path d="M3,3 29,3 M3,16 29,16 M3,29 29,29"></path>
            </svg>
            Menu
        </label>
        <nav>
            <ol>
                <li class="">
                    <a href="/">About Phel</a>
                </li>
                
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;getting-started&#x2F;">Getting started</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;basic-types&#x2F;">Basic Types</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;numbers-and-arithmetic&#x2F;">Numbers and Arithmetic</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;truth-and-boolean-operations&#x2F;">Truth and Boolean operations</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;control-flow&#x2F;">Control flow</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;global-and-local-bindings&#x2F;">Global and local bindings</a>
                    </li>
                
                    <li class="active">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;functions-and-recursion&#x2F;">Functions and Recursion</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;tuple&#x2F;">Tuple</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;array-table-and-struct&#x2F;">Array, Table, Struct and Set</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;destructuring&#x2F;">Destructuring</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;macros&#x2F;">Macros</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;namespaces&#x2F;">Namespaces</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;php-interop&#x2F;">PHP Interop</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;http-request-and-response&#x2F;">Request and Response</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;html-rendering&#x2F;">HTML Rendering</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;testing&#x2F;">Testing</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;configuration&#x2F;">Configuration</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;repl&#x2F;">REPL</a>
                    </li>
                
                    <li class="">
                        <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;documentation&#x2F;api&#x2F;">API</a>
                    </li>
                
            </ol>

            <ul>
                <li><a href="https://github.com/phel-lang/phel-lang">Source on Github</a></li>
            </ul>
        </nav>
    </aside>
    <div class="documentation__content">
        
    <h1>Functions and Recursion</h1>
    <h2 id="anonymous-function-fn">Anonymous Function (fn)</h2>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[params*] expr*)
</span></code></pre>
<p>Defines a function. A function consists of a list of parameters and a list of expression. The value of the last expression is returned as the result of the function. All other expression are only evaluated for side effects. If no expression is given, the function returns <code>nil</code>.</p>
<p>Function also introduce a new lexical scope that is not accessible outside of the function.</p>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[]) </span><span style="color:#999999;"># Function with no arguments that returns nil
</span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[x] x) </span><span style="color:#999999;"># The identity function
</span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[] </span><span style="color:#f5871f;">1 2 3</span><span style="color:#4d4d4c;">) </span><span style="color:#999999;"># A function that returns 3
</span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[a b] (+ a b)) </span><span style="color:#999999;"># A function that returns the sum of a and b
</span></code></pre>
<p>Function can also be defined as variadic function with an infite amount of arguments using the <code>&amp;</code> separator.</p>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[&amp; args] (count args)) </span><span style="color:#999999;"># A variadic function that counts the arguments
</span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[a b c &amp;]) </span><span style="color:#999999;"># A variadic function with extra arguments ignored
</span></code></pre>
<p>There is a shorter form to define an anonymous function. This omits the parameter list and names parameters based on their position.</p>
<ul>
<li><code>$</code> is used for a single parameter</li>
<li><code>$1</code>, <code>$2</code>, <code>$3</code>, etc are used for multiple parameters</li>
<li><code>$&amp;</code> is used for the remaining variadic parameters</li>
</ul>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">|(+ </span><span style="color:#f5871f;">6</span><span style="color:#4d4d4c;"> $) </span><span style="color:#999999;"># Same as (fn [x] (+ 6 x))
</span><span style="color:#4d4d4c;">|(+ $</span><span style="color:#f5871f;">1</span><span style="color:#4d4d4c;"> $</span><span style="color:#f5871f;">2</span><span style="color:#4d4d4c;">) </span><span style="color:#999999;"># Same as (fn [a b] (+ a b))
</span><span style="color:#4d4d4c;">|(sum $&amp;) </span><span style="color:#999999;"># Same as (fn [&amp; xs] (sum xs))
</span></code></pre><h2 id="global-functions">Global functions</h2>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">defn</span><span style="color:#4d4d4c;"> docstring? attributes? [params*] expr*)
</span></code></pre>
<p>Global functions can be defined using <code>defn</code>.</p>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">defn</span><span style="color:#4d4d4c;"> my-add-function [a b]
  (+ a b))
</span></code></pre>
<p>Each global function can take an optional doc comment and attribute map.</p>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">defn</span><span style="color:#4d4d4c;"> my-add-function
  </span><span style="color:#718c00;">&quot;adds value a and b&quot;
  </span><span style="color:#4d4d4c;">[a b]
  (+ a b))

(</span><span style="color:#8959a8;">defn</span><span style="color:#4d4d4c;"> my-private-add-function
  </span><span style="color:#718c00;">&quot;adds value a and b&quot;
  </span><span style="color:#4d4d4c;">@{</span><span style="color:#3e999f;">:private </span><span style="color:#f5871f;">true</span><span style="color:#4d4d4c;">}
  [a b]
  (+ a b))
</span></code></pre><h2 id="recursion">Recursion</h2>
<p>Similar to <code>loop</code>, functions can be made recursive using <code>recur</code>.</p>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[x]
  (</span><span style="color:#8959a8;">if </span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">php/==</span><span style="color:#4d4d4c;"> x </span><span style="color:#f5871f;">0</span><span style="color:#4d4d4c;">)
    x
    (</span><span style="color:#8959a8;">recur </span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">php/-</span><span style="color:#4d4d4c;"> x </span><span style="color:#f5871f;">1</span><span style="color:#4d4d4c;">))))

(</span><span style="color:#8959a8;">defn</span><span style="color:#4d4d4c;"> my-recur-fn [x]
  (</span><span style="color:#8959a8;">if </span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">php/==</span><span style="color:#4d4d4c;"> x </span><span style="color:#f5871f;">0</span><span style="color:#4d4d4c;">)
    x
    (</span><span style="color:#8959a8;">recur </span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">php/-</span><span style="color:#4d4d4c;"> x </span><span style="color:#f5871f;">1</span><span style="color:#4d4d4c;">))))
</span></code></pre><h2 id="apply-functions">Apply functions</h2>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">apply</span><span style="color:#4d4d4c;"> f expr*)
</span></code></pre>
<p>Calls the function with the given arguments. The last argument must be a list of values, which are passed as separate arguments, rather than a single list. Apply returns the result of the calling function.</p>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">apply</span><span style="color:#4d4d4c;"> + [</span><span style="color:#f5871f;">1 2 3</span><span style="color:#4d4d4c;">]) </span><span style="color:#999999;"># Evaluates to 6
</span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">apply</span><span style="color:#4d4d4c;"> + </span><span style="color:#f5871f;">1 2 </span><span style="color:#4d4d4c;">[</span><span style="color:#f5871f;">3</span><span style="color:#4d4d4c;">]) </span><span style="color:#999999;"># Evaluates to 6
</span><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">apply</span><span style="color:#4d4d4c;"> + </span><span style="color:#f5871f;">1 2 3</span><span style="color:#4d4d4c;">) </span><span style="color:#999999;"># BAD! Last element must be a list
</span></code></pre><h2 id="passing-by-reference">Passing by reference</h2>
<p>Sometimes it is required that a variable should pass to a function by reference. This can be done by applying the <code>:reference</code> metadata to the symbol.</p>
<pre style="background-color:#ffffff;">
<code><span style="color:#4d4d4c;">(</span><span style="color:#8959a8;">fn </span><span style="color:#4d4d4c;">[^</span><span style="color:#3e999f;">:reference</span><span style="color:#4d4d4c;"> my-arr]
  (</span><span style="color:#8959a8;">php/apush</span><span style="color:#4d4d4c;"> my-arr </span><span style="color:#f5871f;">10</span><span style="color:#4d4d4c;">))
</span></code></pre>
<p>Support for references is very limited in Phel. Currently, it only works for function arguments (except destructuring).</p>



        <footer>
    &copy; <time datetime="2020">2020</time> Jens Haase
    <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;legal&#x2F;disclosure&#x2F;">Legal Disclosure</a> | <a href="https:&#x2F;&#x2F;phel-lang.org&#x2F;legal&#x2F;data-protection&#x2F;">Data protection</a>
</footer>
    </div>
</div>

</body>

</html>
